<div>
  <form class="main-form">
    <!-- Matter form field -->
    <mat-form-field [style.fontSize]="fontSize">
      <mat-label>Matter</mat-label>
      <textarea matInput name="matter" [formControl]="formControl.matter" (blur)="putNewMatter()" required
          cdkTextareaAutosize
          #autosize="cdkTextareaAutosize"></textarea>
      <mat-error *ngIf="formControl['matter'].invalid">{{getErrorMessage('matter')}}</mat-error>
    </mat-form-field>
    <!-- Date form field -->
    <mat-form-field>
      <mat-label>Choose a date</mat-label>
      <input matInput name="date" [matDatepicker]="datepicker" [formControl]="formControl.date" readonly>
      <mat-datepicker-toggle matSuffix [for]="datepicker"></mat-datepicker-toggle>
      <mat-datepicker #datepicker>
        <mat-datepicker-actions>
          <button mat-button matDatepickerCancel>Cancel</button>
          <button mat-raised-button color="primary" matDatepickerApply (click)="putNewDate()">Apply</button>
        </mat-datepicker-actions>
      </mat-datepicker>
    </mat-form-field>
    <!-- Merchants form field -->
    <mat-form-field class="example-chip-list">
      <mat-label>Merchants</mat-label>
      <mat-chip-list #chipMerchantList aria-label="Merchant selection">
        <!-- Show actual merchants -->
        <mat-chip
          *ngFor="let merchant of actualMerchants"
          [selectable]="selectable"
          [removable]="removable"
          (removed)="removeMerchant($event, merchant)">
          {{merchant}}
          <mat-icon matChipRemove *ngIf="removable && moreThanOneMerchants">cancel</mat-icon>
        </mat-chip>
        <input id="merchantInput"
          name="merchantsCtrl"
          placeholder="New merchant..."
          #merchantInput
          [formControl]="formControl.merchantsCtrl"
          [matAutocomplete]="auto"
          [matChipInputFor]="chipMerchantList">
      </mat-chip-list>
      <mat-autocomplete #auto="matAutocomplete"
      (optionSelected)="postMerchant($event, 'merchantInput', formControl.merchantsCtrl)">
        <mat-option *ngFor="let merchant of filteredMerchants">
          {{merchant.name + '/' + merchant.email}}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
    <!-- Client form field -->
    <mat-form-field class="example-chip-list">
      <mat-label>Clients</mat-label>
      <!-- Show actual clients -->
      <mat-chip-list #chipClientList aria-label="Client selection">
        <mat-chip
          *ngFor="let client of actualClients"
          [selectable]="selectable"
          [removable]="removable"
          (removed)="removeClient($event, client)"
          (click)="goToModifyClient(client)">
          {{client}}
          <mat-icon matChipRemove *ngIf="removable && moreThanOneClients">cancel</mat-icon>
        </mat-chip>
        <!-- TODO: ENVIAR LA PETICION CUANDO LOS CAMPOS OBLIGATORIOS ESTEN  -->
        <!-- TODO: ACABAR EL POST -->
        <input id="clientInput"
          name="clientsCtrl"
          placeholder="New client..."
          #clientInput
          [formControl]="formControl.clientsCtrl"
          [matAutocomplete]="auto1"
          [matChipInputFor]="chipClientList">
      </mat-chip-list>
      <mat-autocomplete #auto1="matAutocomplete"
      (optionSelected)="postClient($event, 'clientInput', formControl.clientsCtrl)">
        <mat-option *ngFor="let client of filteredClients">
          {{client.name + '/' + client.email}}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
    <!-- Description form field -->
    <mat-form-field>
      <mat-label>Description</mat-label>
      <textarea matInput style="min-height: 200px;" name="description" [formControl]="formControl.description" (blur)="putNewDescription()"></textarea>
    </mat-form-field>
    <!-- Keywords form field -->
    <mat-form-field class="example-chip-list">
      <mat-label>Keywords</mat-label>
      <mat-chip-list #chipKeywordList aria-label="Keyword selection">
        <mat-chip *ngFor="let keyword of data.keywords" [selectable]="selectable"
                 [removable]="removable" (removed)="removeKeyword(keyword)">
          {{keyword}}
          <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
        </mat-chip>
        <input id="keywordInput"
          placeholder="New keywords..."
          [formControl]="formControl.keywordsCtrl"
          [matChipInputFor]="chipKeywordList"
          [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
          (matChipInputTokenEnd)="postKeyword($event)">
      </mat-chip-list>
    </mat-form-field>
  </form>
</div>
